
## Module 6: Exercices

Dans ces exercices, nous allons voir comment effectuer des tests d'hypothèses statistiques en R, en utilisant un nouveau jeu de données. Nous avons suffisamment étudié les données de `BeanSurvey` pour le moment ! 

Nous avons exploré un certain nombre de questions graphiquement, et avec des statistiques sommaires, et maintenant nous pouvons conduire des tests d'hypothèse pour nous dire si nous pouvons conclure qu'il y a des différences statistiquement significatives.

Si vous avez ouvert ce fichier sans avoir d'abord décompressé tous les fichiers dans un seul dossier, et sans avoir créé un fichier de projet pour ces exercices, alors arrêtez tout de suite. Faites ces choses !

Maintenant que vous êtes de retour, vous pouvez installer toutes les bibliothèques utilisées dans cette session que vous n'avez peut-être pas déjà. Vous devriez déjà avoir `ggplot2` et `dplyr` ; mais vous aurez probablement besoin d'installer aussi `janitor`.

Une fois que vous avez fait cela, vous êtes maintenant prêt à partir et l'exécution du chunk ci-dessous devrait charger les bibliothèques et importer les données qui seront utilisées dans ces exercices.



```{r}
library(ggplot2)
library(dplyr)
library(janitor)

fallowsurvey<-read.csv("fallowsurvey.csv")

```

## Données

These data are from a much larger survey of Kenyan farmers to determine whether they left their fields fallow in any of the previous three years. The variables included are:
*ID* - An ID for the farmer
*Fallow_yr1* - Whether the farmer left their plot fallow in the last season.
*Fallow_yrw* - If the farmer left the plot fallow two seasons ago.
*Fallow_yre* - Indicates whether the farmer has left the plot fallow three seasons previously.
*wealth* - An index of wealth based on the assets owned by the farmer - a higher score indicates greater wealth.
*education* - The level of education of the head of the household.
*Adults* - Number of adults in the household.
*Ethnicity* - Ethnicity of the head of the household.
*hhgender* - Gender of the head of the household.

## Exercice 1

Tout d'abord, nous allons examiner s'il existe une relation entre le statut de richesse de l'agriculteur et l'appartenance ethnique du chef de famille.

*Question 1.1 : Produire des statistiques sommaires montrant la moyenne et l'écart-type de la richesse pour chacune des deux ethnies, en utilisant `group_by` et `summarise`*.

```{r}
fallowsurvey %>%
  group_by(ethnicity) %>%
    summarise(mean(wealth),sd(wealth))

```

*Question 1.2 : Produire des boxplots montrant la distribution de la richesse par ethnie*.

```{r}
ggplot(fallowsurvey,aes(y=wealth,x=ethnicity))+
  geom_boxplot()
```

*Question 1.3 : Effectuez un test t pour vérifier s'il existe une différence significative entre les scores de richesse des deux ethnies. Interprétez les résultats*.

```{r}
t.test(wealth~ethnicity,data=fallowsurvey)
```

## Exercice 2

Examinons maintenant la relation entre l'ethnicité et le fait que la parcelle ait été laissée en jachère. 


La recommandation pour les parcelles en jachère est de laisser la parcelle en jachère pendant au moins une saison sur trois. Nous ne sommes donc pas intéressés à savoir si la parcelle a été laissée en jachère au cours de la dernière saison, ou il y a deux saisons, mais nous sommes intéressés à savoir si elle a été laissée en jachère tout court. Nous devrons donc d'abord créer une nouvelle variable !
*Question 2.1 : Utilisez mutate pour calculer une nouvelle variable appelée "Fallow_Last3" qui prend la valeur "Oui" si la parcelle a été laissée en jachère au cours de l'une des trois dernières années et prend la valeur "Non" si la parcelle n'a pas été laissée en jachère au cours de l'une des trois dernières années*.

```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) 
```

*Question 2.2 : En partant de la dernière étape, et en utilisant la variable que vous avez créée à la dernière étape, calculez les pourcentages d'agriculteurs de chaque ethnie qui ont laissé leur parcelle en jachère pendant au moins une des dernières saisons en utilisant les fonctions `tabyl` et `adorn_percentages` *.


```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    tabyl(ethnicity,Fallow_Last3) %>%
      adorn_percentages()
```

*Question 2.3 : Effectuez un test de chi-deux pour déterminer s'il existe une relation significative entre le fait que l'agriculteur ait laissé sa parcelle en jachère et l'appartenance ethnique du chef de famille.

```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    tabyl(ethnicity,Fallow_Last3) %>%
      chisq.test()
```

## Exercice 3

Examinez maintenant s'il existe une relation entre le niveau d'éducation du chef de ménage et le fait que la parcelle ait été laissée en jachère, en utilisant la variable que vous avez calculée à la question 2.1.
Produisez des statistiques sommaires, puis effectuez un test d'hypothèse approprié.
Vous remarquerez peut-être un problème cette fois-ci avec la réalisation du test du chi-deux ! Réfléchissez à la manière appropriée de remédier à ce problème en utilisant l'une des trois options présentées dans le cahier d'exercices : `filter` pour supprimer des catégories, `mutate` et `recode` pour combiner des catégories, ou `fisher.test` pour utiliser un test non-paramétrique.


```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    tabyl(hheducation,Fallow_Last3) 

fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    tabyl(hheducation,Fallow_Last3) %>%
      adorn_percentages()

fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    tabyl(hheducation,Fallow_Last3) %>%
      chisq.test()

fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
  filter(hheducation !="other") %>%
    tabyl(hheducation,Fallow_Last3) %>%
      chisq.test()
```



## Exercise 4

Enfin, examinons la relation entre la richesse et l'état de jachère de la parcelle, en utilisant à nouveau la variable "Fallow_Last3" que vous avez créée dans l'exercice 2. Produisez des statistiques et des graphiques récapitulatifs, puis choisissez un test statistique approprié pour étudier la relation et interpréter les résultats. Vérifiez si ce que vous avez fait a du sens.

```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    group_by(Fallow_Last3)  %>%
      summarise(mean(wealth),sd(wealth))

```

```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    ggplot(aes(y=wealth,x=Fallow_Last3))+
      geom_boxplot()

```
```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    t.test(wealth~Fallow_Last3,data=.)
```

```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    mutate(wealth_cat=cut(wealth,breaks=c(-1,1.5,3,99))) %>%
      tabyl(wealth_cat,Fallow_Last3) %>%
        adorn_percentages()
```

```{r}
fallowsurvey %>%
  mutate(Fallow_Last3=ifelse(Fallow_yr1=="Yes"|Fallow_yr2=="Yes"|Fallow_yr3=="Yes","Yes","No")) %>%
    mutate(wealth_cat=cut(wealth,breaks=c(-1,1.5,3,99))) %>%
      tabyl(wealth_cat,Fallow_Last3) %>%
        chisq.test()
```

